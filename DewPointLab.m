% Humidity and temperature are read from a JSON string to calculate
% dew point. 



% Get time, temp and humidity from the JSON string
txt=sprintf('{"time": ["30-09-2019 13:58:14",\n\r"30-09-2019 13:59:10",\r\n"30-09-2019 14:00:10","30-09-2019 14:01:09","30-09-2019 14:02:10","30-09-2019 14:03:10","30-09-2019 14:04:09","30-09-2019 14:05:09","30-09-2019 14:06:16","30-09-2019 14:07:10","30-09-2019 14:08:10","30-09-2019 14:09:10","30-09-2019 14:10:12","30-09-2019 14:11:09","30-09-2019 14:12:09","30-09-2019 14:13:18","30-09-2019 14:14:22","30-09-2019 14:15:10","30-09-2019 14:16:09","30-09-2019 14:17:11","30-09-2019 14:18:09","30-09-2019 14:19:09","30-09-2019 14:20:09","30-09-2019 14:21:11","30-09-2019 14:22:09","30-09-2019 14:23:09","30-09-2019 14:24:10","30-09-2019 14:25:09","30-09-2019 14:26:10","30-09-2019 14:27:10","30-09-2019 14:28:11","30-09-2019 14:29:09","30-09-2019 14:30:10","30-09-2019 14:31:09","30-09-2019 14:32:10","30-09-2019 14:33:09","30-09-2019 14:34:09","30-09-2019 14:35:10","30-09-2019 14:36:10","30-09-2019 14:37:11","30-09-2019 14:38:09","30-09-2019 14:39:09","30-09-2019 14:40:09","30-09-2019 14:41:09","30-09-2019 14:42:10","30-09-2019 14:43:20","30-09-2019 14:44:16","30-09-2019 14:45:12","30-09-2019 14:46:12","30-09-2019 14:47:12","30-09-2019 14:48:09","30-09-2019 14:49:12","30-09-2019 14:49:27","30-09-2019 14:50:13","30-09-2019 14:50:28","30-09-2019 14:51:10","30-09-2019 14:52:10","30-09-2019 14:53:09","30-09-2019 14:54:10","30-09-2019 14:55:10"],"temp": [26.94,26.93,26.94,26.92,26.94,26.93,26.93,26.93,26.93,26.94,26.92,26.94,26.92,26.92,26.93,26.93,26.93,26.93,26.92,26.94,26.92,26.93,26.92,26.92,26.93,26.92,26.92,26.92,26.9,26.93,26.92,26.94,26.94,26.94,26.92,26.93,26.94,26.92,26.93,26.92,26.91,26.92,26.94,26.92,26.91,26.91,26.93,26.91,26.92,26.91,26.91,26.92,26.92,26.9,26.9,26.94,26.92,26.92,26.92,26.92],"humidity": [64.78,64.75,64.77,64.77,64.75,64.78,64.78,64.78,64.78,64.77,64.77,64.77,64.77,64.77,64.74,64.76,64.76,64.75,64.79,64.75,64.77,64.73,64.76,64.75,64.74,64.75,64.75,64.75,64.75,64.76,64.75,64.74,64.75,64.72,64.73,64.75,64.74,64.73,64.71,64.73,64.72,64.73,64.72,64.75,64.72,64.72,64.73,64.73,64.73,64.75,64.74,64.77,64.77,64.75,64.75,64.74,64.72,64.74,64.72,64.73]}');
txt=regexprep(txt,"[\n\r]+",'');
record=jsondecode(txt);
% txt1 = jsonencode({time, temp, humidity});


% Get humidity data from the record
humidity = record.humidity;

% Convert temperature from Fahrenheit to Celsius

%tempC = (5/9)*(temp-32);
tempC = record.temp;

% Calculate dew point

% Specify the constants for water vapor (b) and barometric (c) pressure.
b = 17.62;
c = 243.5;
% Calculate the intermediate value 'gamma'
gamma = log(humidity/100) + b*tempC ./ (c+tempC);
% Calculate dew point in Celsius
dewPoint = c*gamma ./ (b-gamma);
% Convert to dew point in Fahrenheit
dewPointF = (dewPoint*1.8) + 32;
display(record.time, 'time');
display(tempC, 'temp');
display(record.humidity, 'humidity');
display(dewPoint, 'dewPoint')
display(record.time, 'time');
plot(datetime(record.time,'InputFormat','dd-MM-yyyy HH:mm:ss'),tempC);
plot(datetime(record.time,'InputFormat','dd-MM-yyyy HH:mm:ss'),dewPoint);
